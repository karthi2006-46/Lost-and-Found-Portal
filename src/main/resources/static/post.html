<!doctype html>
<html>
<head><meta charset="utf-8"/><title>Report</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="p-4">
<div class="container">
  <h3>Report Lost / Found Item</h3>
  <form id="postForm" enctype="multipart/form-data">
    <input name="title" class="form-control mb-2" placeholder="Item title" required/>
    <textarea name="description" class="form-control mb-2" placeholder="Description"></textarea>
    <input name="location" class="form-control mb-2" placeholder="Location"/>
    <input name="dateEvent" type="date" class="form-control mb-2"/>
    <input name="category" class="form-control mb-2" placeholder="Category (e.g., Electronics, Wallet)"/>
    <select name="lost" class="form-select mb-2"><option value="true">Lost</option><option value="false">Found</option></select>
    <input type="file" name="photo" class="form-control mb-2"/>
    <button class="btn btn-primary">Submit</button>
  </form>
  <div id="msg" class="mt-2"></div>
</div>

<script>
document.getElementById('postForm').addEventListener('submit', async (e) => {
  e.preventDefault();
 const token = localStorage.getItem('token');
  if (!token) { alert('Please login first'); window.location='/login.html'; return; }
  const fd = new FormData(e.target);
  // ensure lost value boolean
  fd.set('lost', fd.get('lost'));
  const res = await fetch('/api/items', {
    method:'POST',
    headers: { 'Authorization': 'Bearer '+token },
    body: fd
  });
  if (res.ok) {
    document.getElementById('msg').innerHTML = '<div class="alert alert-success">Posted successfully (pending verification)</div>';
    e.target.reset();
  } else {
    const t = await res.text();
    document.getElementById('msg').innerHTML = '<div class="alert alert-danger">'+t+'</div>';
  }
});
</script>
</body>
</html>