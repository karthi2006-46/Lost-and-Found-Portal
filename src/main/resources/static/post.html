<!doctype html>
<html>
<head>
<meta charset="utf-8"/>
<title>Report Item</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

</head>

<body class="bg-light">

<nav class="navbar navbar-expand-lg navbar-dark bg-primary shadow">
<div class="container">

<a class="navbar-brand fw-bold">Lost & Found Portal</a>

<div class="ms-auto d-flex align-items-center gap-2">

  <a href="/" class="btn btn-light btn-sm rounded-pill px-3">
    <i class="fa fa-home me-1"></i> Home
  </a>

  <a href="/my-claims.html" class="btn btn-warning btn-sm rounded-pill px-3">
    <i class="fa fa-list me-1"></i> My Claims
  </a>

  <span class="badge bg-light text-dark rounded-pill px-3 py-2">
    <i class="fa fa-user-circle me-1"></i>
    <span id="user"></span>
  </span>

  <button onclick="logout()" class="btn btn-danger btn-sm rounded-pill px-3">
    <i class="fa fa-sign-out-alt me-1"></i> Logout
  </button>

</div>
</div>
</nav>



<div class="container mt-4">
<div class="card shadow p-4">
<h4>Report Lost / Found Item</h4>

<form id="postForm" enctype="multipart/form-data">
<input name="title" class="form-control mb-2" placeholder="Item title" required>

<textarea name="description" class="form-control mb-2" placeholder="Description"></textarea>

<input name="location" class="form-control mb-2" placeholder="Location">

<input name="mobile" class="form-control mb-2" placeholder="Mobile Number" required>

<input name="dateEvent" type="date" class="form-control mb-2" required>

<input name="category" class="form-control mb-2" placeholder="Category">

<select name="lost" class="form-control mb-2">
<option value="true">Lost</option>
<option value="false">Found</option>
</select>

<input type="file" name="photo" class="form-control mb-3">

<button class="btn btn-primary w-100">Submit</button>
</form>


<div id="msg" class="mt-3"></div>
</div>
</div>

<script>
const token = localStorage.getItem("token");

document.getElementById("postForm").onsubmit = async (e)=>{
 e.preventDefault();
 let fd = new FormData(e.target);

 let isLost = fd.get("lost") === "true";

 let headers = {};
 if(isLost){
   if(!token){
     alert("Login required to report lost item");
     window.location="/login.html";
     return;
   }
   headers["Authorization"] = "Bearer " + token;
 }

 let res = await fetch("/api/items",{
   method:"POST",
   headers,
   body: fd
 });

 if(res.ok){
   msg.innerHTML="<div class='alert alert-success'>Item posted successfully</div>";
   e.target.reset();
 } else {
   msg.innerHTML="<div class='alert alert-danger'>Failed</div>";
 }
};
</script>

</body>
</html>
